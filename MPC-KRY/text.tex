\section{Formální definice kryptografického systému, symetrické a asymetrické šifry. Výpočetně těžké matematické problémy pro~asymetrické šifry.}

\subsection{Definice}

\uline{Kryptografický systém} pro~šifrování zpráv je pětice $(\mathcal{M}, \mathcal{C}, \mathcal{K}, \mathcal{E}, \mathcal{D})$, kde
$\mathcal{M}$ je prostor otevřených zpráv,
$\mathcal{C}$ prostor šifrových zpráv,
$\mathcal{K}$ prostor klíčů,
$\mathcal{E}, \mathcal{D}$ dvojice zobrazení, které každému klíči $k \in \mathcal{K}$ přiřazují transformaci pro~zašifrování zpráv $E$ a~transformaci pro~dešifrování zpráv $D$, kde platí $D(k(E(k,m))=m \ \forall \ k \in \mathcal{K}, m \in \mathcal{M}$.

\uline{Symetrická šifra} je taková šifra, kde pro~každé $k \in \mathcal{K}$ lze z~transformace zašifrování $E_k$ určit transformaci dešifrování $D_k$ a naopak.

\uline{Asymetrická šifra} je taková šifra, kde pro~skoro všechna $k \in \mathcal{K}$ nelze z~transformace pro~zašifrování $E_k$ určit transformaci dešifrování $D_k$.
Bývá zde přítomen tajný klíč $k$, ze~kterého se vhodnou transformací $G$ vygeneruje dvojice parametrů $(e, d)$, která tvoří veřejné a~privátní klíče ($k_\text{pub}$, $k_\text{priv}$).
Ty parametrizují transformace šifrování a dešifrování.

\subsection{Matematické problémy asymetrických šifer}

\subsubsection{Problém diskrétního logaritmu}

Rovnice $c \equiv m^n \mod p$ je výpočetně jednoduchá a rychlá, získání $m$ z~$c$ je naopak složité.

DLP využívají protokoly Diffie-Hellman, ElGamal, DSA, ECDL, ECDSA, \dots

Mezi algoritmy řešení patří brute-force, baby step--giant step, Pollardův $\rho$ algoritmus, funkční síto, \dots

\subsubsection{Problém faktorizace}

Faktorizace je proces převodu složeného čísla na~jeho prvočíselné složky.

FP využívá například RSA.

Mezi algoritmy řešení patří brute-force, Pollardůvo $\rho$ algoritmus, Pollardův $\rho - 1$ algoritmus, Lehmannova metoda, kvadratické síto, \dots


\clearpage
\section{Služby bezpečnosti zajišťované kryptografickými prostředky, kryptografické mechanismy, které tyto služby zajišťují.}

\subsection{Služby}

\uline{Autentizace} (\emph{authentication}) je proces ověření identity entity.
\emph{Peer Entity Authentication} ověřuje uživatele,
\emph{Data Origin Authentication} ověřuje všechna data a eliminuje např. útoky opakováním.

\uline{Řízení přístupu} (\emph{access control}) je možnost povolit či odepřít použití určitého zdroje určitému subjektu.

\uline{Zabezpečení důvěrnosti dat} (\emph{data confidentiality}) je ochrana obsahu proti analýze.
Může jít o~zajištění důvěrnosti přenosu zpráv, spojení, toku dat nebo služby selektivní důvěrnosti (které chrání pouze část informace).

\uline{Zabezpečení integrity dat} (\emph{data integrity}) je ochrana proti neautorizované modifikaci.
Slabá integrita: modifikace zprávy šumem, změna pořadí paketů, náhodná duplicita (kontrolní součet, CRC, pořadové číslo).
Silná integrita: podvržení zprávy, úmyslné pozměnění zprávy; bez~oprav a s~opravami.

\uline{Ochrana proti odmítnutí původu zprávy} (\emph{non-repudiation}) zajišťuje důkaz o~původu dat a dokazuje původ nebo doručení.

\subsection{Mechanismy}

Šifrování, digitální podpisy, řízení přístupu, mechanismy integrity dat, výměna autentizační informace, padding, řízení směrování, ověření třetí stranou.

\begin{table}[ht]
	\centering
	\onehalfspacing

	\begin{tabular}{|l|cccccccc|}
		&
		\begin{sideways}šifrování\end{sideways} &
		\begin{sideways}podpis\end{sideways} &
		\begin{sideways}řízení přístupu\end{sideways} &
		\begin{sideways}integrita\end{sideways} &
		\begin{sideways}autentizace\end{sideways} &
		\begin{sideways}padding\end{sideways} &
		\begin{sideways}řízení směrování\end{sideways} &
		\begin{sideways}ověření třetí stranou\end{sideways} \\
		\hline\hline
		%                              š   p   ř   i   a   p   ř   o
		autentizace spojení          & X & X &   &   & X &   &   &   \\
		autentizace odesílatele      & X & X &   &   &   &   &   &   \\
		řízení přístupu              &   &   & X &   &   &   &   &   \\
		důvěrnost spojení            & X &   &   &   &   &   &   &   \\
		důvěrnost přenosu zpráv      & X &   &   &   &   &   & X &   \\
		selektivní důvěrnost         & X &   &   &   &   &   & X &   \\
		důvěrnost toku dat           & X &   &   &   &   & X & X &   \\
		integrita spojení s~opravou  & X &   &   & X &   &   &   &   \\
		integrita spojení bez~opravy & X &   &   & X &   &   &   &   \\
		selektivní integrita spojení & X & X &   & X &   &   &   &   \\
		integrita přenosu zpráv      & X & X &   & X &   &   &   &   \\
		nepopiratelnost odesílatele  & X & X &   & X &   &   &   & X \\
		nepopiratelnost doručení     & X & X &   & X &   &   &   & X \\
	\end{tabular}

	\caption{Matice mechanismů bezpečnosti}
\end{table}


\clearpage
\section{Kryptograficky bezpečné generátory náhodných čísel –- požadavky, hodnocení bezpečnosti, příklady realizace.}
\subsection{Požadavky}
\begin{itemize}
    \item \uline{"Next-bit test"} - je-li známo prvních k bitů náhodné posloupnosti, neexistuje žádný algoritmus s polynomiální složitostí, který by dokázal předpovědět (k + 1) bit s pravděpodobností vyšší než 1/2
    \item \uline{"State compromise"} - i když je zjištěn vnitřní stav generátoru (celý nebo z části), nelze zpětně zrekonstruovat dosavadní vygenerovanou posloupnost. Navíc, pokud do generátoru za běhu vstupuje další entrope, nemělo by být možné ze znalosti vnitřního stavu předpovědět vnitřní stav v následujících iteracích
    \item vetšina používaných PRNG tyto požadavky splňuje jen za určitých podmínek
\end{itemize}

\subsection{Hodnocení bezpečnosti}
Entropie
\begin{itemize}
    \item veličina entropie popisuje míru náhodnosti - jak obtížné je hodnotu (náhodné číslo, náhodnou posloupnost, řetězec náhodných bitů) uhodnout
    \item míra nejistoty (nepředvídatelnosti) hodnoty a závisí na pravděpodobnostech možných výsledků procesu, který ji generuje
    \item dána vztahem:
\end{itemize}
\begin{align*}
    H(X) = - \displaystyle\sum\limits_{i-1}^n p_{i} \log_2 p_{i} 
\end{align*}
\begin{itemize}
    \item X - generovaná hodnota
    \item $p_{1},..., p_{n}$ - pravděpodobnosti všech hodnot $X_{1},..., X_{n}$, které je daný generátor schopen vygenerovat
    \item vztahuje se k útočníkovu a jeho schopnosti předpovídat vygenerovanou hodnotu - pokud útočník následující generovanou hodnotu s jistotou zná, entropie je nulová = nulová bezpečnosti aplikace, která takto vygenerovanou náhodnou hodnotu využívá
    \item vyjadřuje průměrný počet bitů nutných k zakódování hodnoty při použití optimálního k=odování
    \item vyjadřuje obsažené množství informace vyjádřené v bitech
    \item entropie generátoru je maximální, pokud se pro danou délku (počet bitů) generují všechny možné posloupnosti, každá z nich se stejnou pravděpodobností
\end{itemize}

\subsection{Příklady realizace}
Generátor pseudonáhodných čísel (PRNG)
\begin{itemize}
    \item algoritmicky řešení generátory, využívají výpočetních / SW metod
    \item základní problém - jakýkoliv v současnosti existující program je deterministický = existuje pouze jedna možnost, jak k výsledku dojít
    \item možnost se může jevit náhodná, ale není
    \item pro člověka pouze není snadné zjistit, jakým způsobem byla vytvořena
    \item výhody: rychlé, snadno realizovatelné, lze nastavit odchylku rozložení
    \item nevýhody: malá bezpečnost, periodicita \\
\end{itemize}

Kryptograficky bezpečené PRNG
\begin{itemize}
    \item pokud PRNG splňuje určité požadavky $\longrightarrow$ považujeme na kryptograficky bezpečné
    \item vyžadují náhodný a tajný vstup (seed) - nelze se tedy obejít bez "skutečné náhody"
    \item kvalita závisí na kvalitě generování hodnoty seed
    \item entropie výstupu PRNG je dána entropií, která vstupuje (seed), algoritmus samotný nikdy nemůže entropii zvyšovat
    \item zdroj entropie např.: sběr událostí z pohybu myši, klávesnice, HD a některých přerušení (Linux PRNG)
    \item podmínky:
    \begin{itemize}
        \item Next-bit test
        \item State compromise
    \end{itemize}
    \item příklady:
    \begin{itemize}
        \item bloková šifra v režimu čítače - náhodně se zvolí klíč / seed a počáteční hodnota čítače i. Zvoleným klíčem se postupně šifrují hodnoty i, i+1, atd. dokud nedojde k překročení velikosti bloku - perioda
        \item hashovací funkce aplikovaná na čítač - náhodně se zvolí počáteční hodnota čítače i. Postupně se  hashují hodnoty i, i+1 atd. Nesmí dojít k prozrazení počáteční hodnoty čítače
        \item proudové šifry - v zásadě PRNG, s jehož výstupem se provádí XOR s otevřeným textem
        \item algoritmy založené na teorii čísel - u kterých byl proveden důkaz bezpečnosti \\
    \end{itemize}
\end{itemize}

Generátory skutečně náhodných čísel (TRNG)
\begin{itemize}
    \item využívající fyzikální / HW metody
    \item zdroj entropie - klasický nebo kvantový fyzikální jev
    \item výhody: vysoká bezpečnost, neopakovatelnost
    \item nevýhody: pomalé, problémy s realizací, ne vždy lze dosáhnout maximálně rovnoměrného rozložení
\end{itemize}



\clearpage
\section{Hašovací funkce -- požadavky, hodnocení bezpečnosti. Princip konstrukce -- iterační, typu \enquote{houba} (SHA3).}

\clearpage
\section{Kvantový přenos informace -- důvody použití, příklady protokolů.}

\clearpage
\section{Postkvantová kryptografie –- důvody použití, jaké těžké matematické problémy se zde využívají (kryptosystém McEliece, kryptosystém založený na mřížkách). Jednorázový podpis pomocí hašovacích funkcí (Lamport).}

\clearpage
\section{V~souvislosti s~nařízením eIDAS vysvětlete pojmy -- elektronický podpis, zaručený elektronický podpis a kvalifikovaný elektronický podpis, elektronická pečeť, elektronické časové razítko.}

\clearpage
\section{Technologie blockchain -– struktura, princip, možnosti využití.}

\clearpage
\section{Fyzicky neklonovatelné funkce (FNF) -- k~čemu lze využít, výhody a nevýhody, požadované vlastnosti, příklady.}

\clearpage
\section{Autentizační protokoly –- na jakém principu pracují, využívané proměnné parametry, hodnocení jejich bezpečnosti (BAN logika).}
